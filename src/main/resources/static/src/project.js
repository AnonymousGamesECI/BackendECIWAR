require=function n(c,r,a){function h(o,e){if(!r[o]){if(!c[o]){var t="function"==typeof require&&require;if(!e&&t)return t(o,!0);if(l)return l(o,!0);var i=new Error("Cannot find module '"+o+"'");throw i.code="MODULE_NOT_FOUND",i}var s=r[o]={exports:{}};c[o][0].call(s.exports,function(e){var t=c[o][1][e];return h(t||e)},s,s.exports,n,c,r,a)}return r[o].exports}for(var l="function"==typeof require&&require,e=0;e<a.length;e++)h(a[e]);return h}({Bullet:[function(e,t,o){"use strict";cc._RF.push(t,"bd07dWfWENEjasZeb5tvq5z","Bullet"),cc.Class({extends:cc.Component,properties:{speed:2e3,targetX:0,targetY:0,idBullet:0,shooter:{default:null,type:cc.Node},damage:0},onLoad:function(){},onCollisionEnter:function(e,t){"Kit"!=e.node.name&&"Ammo"!=e.node.name&&this.node.destroy()},update:function(e){var t=Math.atan2(this.targetX,this.targetY);this.node.x+=this.speed*e*Math.sin(t),this.node.y+=this.speed*e*Math.cos(t)}}),cc._RF.pop()},{}],CameraControl:[function(e,t,o){"use strict";cc._RF.push(t,"25fa9oEi19GRoWsA924p5dD","CameraControl"),cc.Class({extends:cc.Component,properties:{target:{default:null,type:cc.Node},camera:cc.Camera,anim:cc.Animation,jumpZoom:!1,centerAtStart:!1,smoothFollow:!1,followX:{default:0,visible:function(){return this.smoothFollow}},followY:{default:0,visible:function(){return this.smoothFollow}},minFollowDist:{default:0,visible:function(){return this.smoothFollow}},followRatio:{default:0,visible:function(){return this.smoothFollow}},overview:!1,overviewTargets:{default:[],type:[cc.Node],visible:function(){return this.overview}},overviewMargin:{default:0,visible:function(){return this.overview}},speedZoom:!1,zoomInSpeed:{default:0,visible:function(){return this.speedZoom}},zoomOutSpeed:{default:0,visible:function(){return this.speedZoom}},canShake:!1,shakeDuration:{default:0,visible:function(){return this.canShake}},pointerPan:!1,pointerXMult:{default:0,visible:function(){return this.pointerPan}},pointerYMult:{default:0,visible:function(){return this.pointerPan}},useBoundaries:!1,topBound:{default:0,visible:function(){return this.useBoundaries}},bottomBound:{default:0,visible:function(){return this.useBoundaries}},leftBound:{default:0,visible:function(){return this.useBoundaries}},rightBound:{default:0,visible:function(){return this.useBoundaries}}},onLoad:function(){this.startFollow=!1;var e=cc.find("Canvas").getComponent(cc.Canvas);this.visibleSize=cc.view.getVisibleSize(),this.initZoomRatio=this.camera.zoomRatio,this.previousPos=this.node.position,this.pointerPan&&(this.overview=!1,this.speedZoom=!1,e.node.on("mousemove",this.onMouseMove,this),e.node.on("touchmove",this.onTouchMove,this),this.pointerPos=null),this.overview&&(this.jumpZoom=!1,this.speedZoom=!1),this.speedZoom&&(this.jumpZoom=!1)},onEnable:function(){cc.director.getPhysicsManager().attachDebugDrawToCamera(this.camera)},onDisable:function(){cc.director.getPhysicsManager().detachDebugDrawFromCamera(this.camera)},lateUpdate:function(e){var t=void 0;t=(this.overview,this.target.position),this.smoothFollow?((Math.abs(t.x-this.node.x)>=this.followX||Math.abs(t.y-this.node.y)>=this.followY)&&(this.startFollow=!0),this.startFollow&&(this.node.position=this.node.position.lerp(t,this.followRatio),cc.pDistance(t,this.node.position)<=this.minFollowDist&&(this.startFollow=!1))):this.node.position=t,this.previousPos=t},getOverviewTargetsMidpoint:function(){for(var e=cc.p(0,0),t=99999,o=99999,i=-99999,s=-99999,n=0;n<this.overviewTargets.length;++n){var c=this.overviewTargets[n];i=c.x>i?c.x:i,t=c.x<t?c.x:t,s=c.y>s?c.y:s,o=c.y<o?c.y:o}i+=this.overviewMargin,t-=this.overviewMargin,s+=this.overviewMargin,o-=this.overviewMargin;var r=Math.abs(i-t),a=Math.abs(s-o);e=cc.p(t+r/2,o+a/2);var h=Math.max(r/this.visibleSize.width,a/this.visibleSize.height);return this.camera.zoomRatio=1/h,e},shakeCamera:function(){this.canShake&&(this.anim.play("shake"),this.scheduleOnce(this.stopShake.bind(this),this.shakeDuration))},stopShake:function(){this.anim.stop(),this.camera.node.position=cc.p(0,0)},onMouseMove:function(e){this.pointerPos=e.getLocation()},onTouchMove:function(e){this.pointerPos=e.getLocation()}}),cc._RF.pop()},{}],HeroControl:[function(e,t,o){"use strict";cc._RF.push(t,"f71dcKFhDRAspNw3w6SBhQq","HeroControl"),cc.Class({extends:cc.Component,properties:{speed:cc.v2(0,0),maxSpeed:cc.v2(400,400),drag:1e3,direction:0,directiony:0,jumpSpeed:0,health:0,ammo:0,bullet:{default:null,type:cc.Node},player2:{default:null,type:cc.Node},healthBar:{default:null,type:cc.ProgressBar},ammoBar:{default:null,type:cc.ProgressBar},usernameLabel:{default:null,type:cc.Label}},onLoad:function(){this.room=cc.find("form").getComponent("MenuController").room,this.isDead=!1,this.health=100,this.ammo=10,this.stompClient=null,this.pi=3.141516,this.id=Math.floor(1e7*Math.random()),this.username=cc.find("form").getComponent("MenuController").username,this.usernameLabel.string=this.username,cc.director.getCollisionManager().enabled=!0,cc.director.getCollisionManager().enabledDebugDraw=!1,cc.find("Camera").on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),this.position=this.node.position,this.rotation=this.node.rotation,this.addBullet=this.addBulletToScene,this.connectAndSubscribe(),cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:this.onKeyPressed.bind(this),onKeyReleased:this.onKeyReleased.bind(this)},this.node),cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseMove:this.onMouseMove.bind(this)},this.node),this.collisionX=0,this.collisionY=0,this.prePosition=cc.v2(),this.preStep=cc.v2(),this.touchingNumber=0},onEnable:function(){cc.director.getCollisionManager().enabled=!0,cc.director.getCollisionManager().enabledDebugDraw=!1},onDisable:function(){cc.director.getCollisionManager().enabled=!1,cc.director.getCollisionManager().enabledDebugDraw=!1},onKeyPressed:function(e,t){if(!this.isDead)switch(e){case cc.KEY.a:case cc.KEY.left:this.direction=-1;break;case cc.KEY.d:case cc.KEY.right:this.direction=1;break;case cc.KEY.w:case cc.KEY.up:this.directiony=1;break;case cc.KEY.s:case cc.KEY.down:this.directiony=-1}},onKeyReleased:function(e,t){switch(e){case cc.KEY.a:case cc.KEY.left:case cc.KEY.d:case cc.KEY.right:this.direction=0;break;case cc.KEY.w:case cc.KEY.up:case cc.KEY.s:case cc.KEY.down:this.directiony=0}},onMouseMove:function(e){var t=Math.floor(e.getLocationX()),o=Math.floor(e.getLocationY()),i={x:t-this.node.position.x,y:o-this.node.position.y},s=Math.atan2(i.x,i.y);this.node.rotation=s*(180/this.pi)},onCollisionEnter:function(e,t){if("Bullet"==e.node.name)this.onShootBegan(e);else if("Wall"==e.node.name){this.touchingNumber++;var o=e.world.aabb,i=e.world.preAabb.clone(),s=t.world.aabb,n=t.world.preAabb.clone();n.x=s.x,i.x=o.x,console.log("col"),cc.Intersection.rectRect(n,i)&&(n.xMax>i.xMax?this.collisionX=-1:n.xMin<i.xMin&&(this.collisionX=1),e.touchingX=!0),n.y=s.y,i.y=o.y,cc.Intersection.rectRect(n,i)&&(n.yMax>i.yMax?this.collisionY=-1:n.yMin<i.yMin&&(this.collisionY=1),e.touchingY=!0)}else"Kit"==e.node.name?(70<=this.health?this.health=100:this.health+=30,this.healthBar.progress=this.health/100):"Ammo"==e.node.name&&(this.ammo+=6,this.ammoBar.progress=this.ammo/50)},onCollisionExit:function(e){this.touchingNumber--,0===this.touchingNumber&&(this.node.color=cc.Color.WHITE),e.touchingX&&(this.collisionX=0,e.touchingX=!1),e.touchingY&&(e.touchingY=!1,this.collisionY=0)},update:function(e){0===this.direction?0<this.speed.x?(this.speed.x-=this.drag*e,this.speed.x<=0&&(this.speed.x=0)):this.speed.x<0&&(this.speed.x+=this.drag*e,0<=this.speed.x&&(this.speed.x=0)):(this.speed.x+=(0<this.direction?1:-1)*this.drag*e,Math.abs(this.speed.x)>this.maxSpeed.x&&(this.speed.x=0<this.speed.x?this.maxSpeed.x:-this.maxSpeed.x)),0===this.directiony?0<this.speed.y?(this.speed.y-=this.drag*e,this.speed.y<=0&&(this.speed.y=0)):this.speed.y<0&&(this.speed.y+=this.drag*e,0<=this.speed.y&&(this.speed.y=0)):(this.speed.y+=(0<this.directiony?1:-1)*this.drag*e,Math.abs(this.speed.y)>this.maxSpeed.y&&(this.speed.y=0<this.speed.y?this.maxSpeed.y:-this.maxSpeed.y)),0===this.speed.y&&0===this.speed.x||this.stompClient.send("/room."+this.room+"/movement",{},JSON.stringify({id:this.id,ps:this.node.position,rt:this.node.rotation})),this.collisionY<0?0<this.speed.y&&(this.node.y+=this.speed.y*e):0<this.collisionY?this.speed.y<0&&(this.node.y+=this.speed.y*e):this.node.y+=this.speed.y*e,this.collisionX<0?0<this.speed.x&&(this.node.x+=this.speed.x*e):0<this.collisionX?this.speed.x<0&&(this.node.x+=this.speed.x*e):this.node.x+=this.speed.x*e},onTouchBegan:function(e){if(console.log(this.ammo),!this.isDead&&0<this.ammo){var t=e.touch.getLocation();cc.log(this.node.position),this.stompClient.send("/room."+this.room+"/newshot",{},JSON.stringify({id:this.id,touchLocX:t.x,touchLocY:t.y,position:this.node.position})),this.ammo-=1,this.ammoBar.progress=this.ammo/50}},onShootBegan:function(e){this.health-=10,this.healthBar.progress=this.health/100,this.health<=0&&this.die()},die:function(){alert("You have died!"),this.isDead=!0,this.node.color=cc.Color.RED,this.active=!1},addBulletToScene:function(e,t,o){var i=cc.director.getScene();(t=cc.instantiate(t)).x=e.position.x,t.y=e.position.y,t.getComponent("Bullet").targetX=e.touchLocX-e.position.x,t.getComponent("Bullet").targetY=e.touchLocY-e.position.y,t.getComponent("Bullet").idBullet=o,t.active=!0,i.addChild(t)},registerInServer:function(){},connectAndSubscribe:function(){var e=new SockJS("/stompendpoint");cc.log("Connecting to WS...."),this.stompClient=Stomp.over(e);var t=this.stompClient,o=(this.position,this.rotation,this.addBullet),i=this.bullet,s=this.player2,n=this.id,c=this.room;this.stompClient.connect({},function(e){console.log("Connected: "+e);t.subscribe("/room."+c+"/movement",function(e){var t=JSON.parse(e.body);n!=t.id&&(s.position=t.ps,s.rotation=t.rt)}),t.subscribe("/room."+c+"/newshot",function(e){var t=JSON.parse(e.body);o(t,i,n),console.log("bullet new shot")}),t.subscribe("/room."+c+"/newdead",function(e){JSON.parse(e.body);die()})})}}),cc._RF.pop()},{}],MenuController:[function(e,t,o){"use strict";var i;function s(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}cc._RF.push(t,"a1ef8J/8lpINZUa6MX6yCNY","MenuController"),cc.Class({extends:cc.Component,properties:(i={username:null,inputName:{default:null,type:cc.EditBox},inputRoom:{default:null,type:cc.EditBox},sendButton:{default:null,type:cc.Node}},s(i,"username",null),s(i,"room",null),i),onLoad:function(){this.stompClient=null,cc.game.addPersistRootNode(this.node),this.connectAndSubscribe()},EditBoxDidEndEditing:function(e){this.username=this.inputName.string,this.room=this.inputRoom.string},onChangedScene:function(e,t){console.log(e),console.log(t),this.node.active=!1},buttonClicked:function(){null==this.username||""==this.username?alert("Please enter a username"):null==this.room||""==this.room?alert("Please enter a room number"):cc.director.loadScene("game",this.onChangedScene(this.username,this.room))},connectAndSubscribe:function(){var e=new SockJS("/stompendpoint");cc.log("Connecting to WS...."),this.stompClient=Stomp.over(e),console.log(this.stompClient);var t=this.stompClient;this.stompClient.connect({},function(e){console.log("Connected: "+e);t.subscribe("/room."+rm+"/movement",function(e){var t=JSON.parse(e.body);idd!=t.id&&(p2.position=t.ps,p2.rotation=t.rt)})})}}),cc._RF.pop()},{}],follow:[function(e,t,o){"use strict";cc._RF.push(t,"feb39Ti3uNP2Kj06Qnzgcqk","follow"),cc.Class({extends:cc.Component,properties:{target:{default:null,type:cc.Node}},onLoad:function(){if(this.node.active=!cc.sys.isMobile,this.target){var e=cc.follow(this.target,cc.rect(155,0,2325,1450));this.node.runAction(e)}}}),cc._RF.pop()},{}],pickUp:[function(e,t,o){"use strict";cc._RF.push(t,"869e0WlQxtPb50nQM++ryWp","pickUp"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},onCollisionEnter:function(e,t){"Bullet"!=e.node.name&&this.node.destroy()}}),cc._RF.pop()},{}]},{},["Bullet","CameraControl","HeroControl","follow","pickUp","MenuController"]);